name: Test all actions
on: [push]
jobs:
  test-suite:
    runs-on: ubuntu-latest
    steps:

      - name: Checkout
        uses: actions/checkout@v1

      - name: Build local image
        uses: ./build-docker-image
        with:
          image_name: http-echo #optional
#          project_root: ./test-app #optional
          build_context: https://github.com/mendhak/docker-http-https-echo.git #optional
          build_args: --build-arg BUILDPLATFORM=amd64 #optional

      - name: Test if image is built successfully
        run:  if docker image ls | grep -q 'http-echo'; then exit 0; else exit 1; fi

      - name: Push to Humanitec
        uses: ./humanitec-push-image
        with:
          humanitec_token: ${{ secrets.HUMANITEC_TOKEN }}
          image-name: http-echo
